<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Visualise the within and between day variation in a time series — pretty_ts_mat • prettyGraphics</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Visualise the within and between day variation in a time series — pretty_ts_mat"><meta property="og:description" content="This function produces a 2-dimensional time plot of a response variable. The surface of the plot shows the response variable in relation to time of day on one axis (usually the x axis) and time of year (specifically, the date) on another axis (usually the y axis). The function was motivated by the need to visualise how the depth of aquatic animals changes over the course of the day and how these patterns change over the course of the year (e.g., as in Teo et al., 2013)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">prettyGraphics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/introducing_prettyGraphics.html">Vignette: An introduction to prettyGraphics</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/edwardlavender/prettyGraphics/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Visualise the within and between day variation in a time series</h1>
    <small class="dont-index">Source: <a href="https://github.com/edwardlavender/prettyGraphics/blob/HEAD/R/pretty_ts_mat.R" class="external-link"><code>R/pretty_ts_mat.R</code></a></small>
    <div class="hidden name"><code>pretty_ts_mat.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function produces a 2-dimensional time plot of a response variable. The surface of the plot shows the response variable in relation to time of day on one axis (usually the x axis) and time of year (specifically, the date) on another axis (usually the y axis). The function was motivated by the need to visualise how the depth of aquatic animals changes over the course of the day and how these patterns change over the course of the year (e.g., as in Teo et al., 2013).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pretty_ts_mat</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">res</span>,</span>
<span>  t1_units <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">/</span><span class="fl">60</span>,</span>
<span>  t2_units <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  retain_orientation <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  xtick_every_n <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  ytick_every_n <span class="op">=</span> <span class="fl">60</span><span class="op">/</span><span class="va">res</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Time (days)"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Time (hours)"</span>,</span>
<span>  return_mat <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>A vector of time stamps in POSIXct (<code><a href="https://rdrr.io/r/base/DateTimeClasses.html" class="external-link">DateTimeClasses</a></code>) format.</p></dd>


<dt>y</dt>
<dd><p>A numeric vector of values of the response variable.</p></dd>


<dt>res</dt>
<dd><p>A number which defines the (minimum) resolution (in minutes) between sequential observations. The function works best with regularly spaced observations in time (see Examples).</p></dd>


<dt>t1_units</dt>
<dd><p>A function which defines the units of the axis of within-day variation. Since <code>res</code> is in minutes, <code>function(x) x</code> results in units of minutes, while the default <code>function(x) x/60</code> results in units of hours.</p></dd>


<dt>t2_units</dt>
<dd><p>A function which defines the format of the axis of between-day variation. The function takes in objects of class <code><a href="https://rdrr.io/r/base/Dates.html" class="external-link">Date</a></code> and returns axis labels. The default option is to retain dates in YYYY-MM-DD format, but other formats (e.g., Julian day) can be expressed via this option.</p></dd>


<dt>retain_orientation</dt>
<dd><p>A logical input which defines whether to plot time of day against time of year (<code>TRUE</code>) or vice-versa (<code>FALSE</code>).</p></dd>


<dt>xtick_every_n</dt>
<dd><p>A numeric input which defines the spacing between sequential tick marks for the x axis (see <code><a href="pretty_mat.html">pretty_mat</a></code>).</p></dd>


<dt>ytick_every_n</dt>
<dd><p>A numeric input which defines the spacing between sequential tick marks for the x axis (see <code><a href="pretty_mat.html">pretty_mat</a></code>).</p></dd>


<dt>xlab</dt>
<dd><p>The x axis label.</p></dd>


<dt>ylab</dt>
<dd><p>The y axis label.</p></dd>


<dt>return_mat</dt>
<dd><p>A logical input which defines whether or not to return the matrix plotted.</p></dd>


<dt>verbose</dt>
<dd><p>A logical input which defines whether or not to print messages to the console. This can be useful in monitoring function progress, especially for large datasets.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments passed to <code><a href="pretty_mat.html">pretty_mat</a></code> for plot customisation.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>The function returns a plot and, if requested, a matrix of time of day (in user-specified units but hours by default) x time of year (in user-specified units but days by default).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Teo, S.L., Sandstrom, P.T., Chapman, E.D., Null, R.E., Brown, K., Klimley, A.P., Block, B.A., 2013. Archival and acoustic tags reveal the post-spawning migrations, diving behavior, and thermal habitat of hatchery-origin Sacramento River steelhead kelts (<em>Oncorhynchus mykiss</em>). Environ. Biol. Fish 96, 175–187.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>The plot is produced by <code><a href="pretty_mat.html">pretty_mat</a></code>.</p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Edward Lavender</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#### Define an example dataframe</span></span></span>
<span class="r-in"><span><span class="va">dfa</span> <span class="op">&lt;-</span> <span class="va">dat_flapper</span><span class="op">[</span><span class="va">dat_flapper</span><span class="op">$</span><span class="va">id</span> <span class="op">==</span> <span class="st">"A"</span>, <span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Example (1): Visualise plot for different response variables</span></span></span>
<span class="r-in"><span><span class="co"># ... sampled at 2 minutes resolution</span></span></span>
<span class="r-in"><span><span class="fu">pretty_ts_mat</span><span class="op">(</span><span class="va">dfa</span><span class="op">$</span><span class="va">timestamp</span>, <span class="va">dfa</span><span class="op">$</span><span class="va">depth</span>, res <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 1: Set up...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 2: Defining time categories...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 3: Creating matrix of time (minutes) x time (days)...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 4: Plotting matrix of time (minutes) x time (days)...</span>
<span class="r-plt img"><img src="pretty_ts_mat-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">pretty_ts_mat</span><span class="op">(</span><span class="va">dfa</span><span class="op">$</span><span class="va">timestamp</span>, <span class="va">dfa</span><span class="op">$</span><span class="va">temp</span>, res <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 1: Set up...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 2: Defining time categories...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 3: Creating matrix of time (minutes) x time (days)...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 4: Plotting matrix of time (minutes) x time (days)...</span>
<span class="r-plt img"><img src="pretty_ts_mat-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Example (2): Adjust the units on the time of day axis via t1_units</span></span></span>
<span class="r-in"><span><span class="fu">pretty_ts_mat</span><span class="op">(</span><span class="va">dfa</span><span class="op">$</span><span class="va">timestamp</span>, <span class="va">dfa</span><span class="op">$</span><span class="va">depth</span>,</span></span>
<span class="r-in"><span>                  res <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                  t1_units <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span>,</span></span>
<span class="r-in"><span>                  ylab <span class="op">=</span> <span class="st">"Time (mins)"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 1: Set up...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 2: Defining time categories...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 3: Creating matrix of time (minutes) x time (days)...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 4: Plotting matrix of time (minutes) x time (days)...</span>
<span class="r-plt img"><img src="pretty_ts_mat-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Example (3): Adjust the format of the time of year axis via t2_units</span></span></span>
<span class="r-in"><span><span class="co"># Julian day</span></span></span>
<span class="r-in"><span><span class="fu">pretty_ts_mat</span><span class="op">(</span><span class="va">dfa</span><span class="op">$</span><span class="va">timestamp</span>, <span class="va">dfa</span><span class="op">$</span><span class="va">depth</span>,</span></span>
<span class="r-in"><span>                  res <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                  t2_units <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/day.html" class="external-link">yday</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 1: Set up...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 2: Defining time categories...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 3: Creating matrix of time (minutes) x time (days)...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 4: Plotting matrix of time (minutes) x time (days)...</span>
<span class="r-plt img"><img src="pretty_ts_mat-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># day-month</span></span></span>
<span class="r-in"><span><span class="fu">pretty_ts_mat</span><span class="op">(</span><span class="va">dfa</span><span class="op">$</span><span class="va">timestamp</span>, <span class="va">dfa</span><span class="op">$</span><span class="va">depth</span>,</span></span>
<span class="r-in"><span>              res <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>              t2_units <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"%d-%m"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 1: Set up...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 2: Defining time categories...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 3: Creating matrix of time (minutes) x time (days)...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 4: Plotting matrix of time (minutes) x time (days)...</span>
<span class="r-plt img"><img src="pretty_ts_mat-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Example (4): Adjust the number of tick marks via xtick_every_n and ytick_every_n</span></span></span>
<span class="r-in"><span><span class="fu">pretty_ts_mat</span><span class="op">(</span><span class="va">dfa</span><span class="op">$</span><span class="va">timestamp</span>, <span class="va">dfa</span><span class="op">$</span><span class="va">depth</span>,</span></span>
<span class="r-in"><span>                  res <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                  t1_units <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span>,</span></span>
<span class="r-in"><span>                  ytick_every <span class="op">=</span> <span class="fl">120</span>,</span></span>
<span class="r-in"><span>                  ylab <span class="op">=</span> <span class="st">"Time (mins)"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 1: Set up...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 2: Defining time categories...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 3: Creating matrix of time (minutes) x time (days)...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 4: Plotting matrix of time (minutes) x time (days)...</span>
<span class="r-plt img"><img src="pretty_ts_mat-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># Other customisation is implemented via ... (see ?prettyGraphics::pretty_mat)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Example (5) The function works best with regularly spaced observations</span></span></span>
<span class="r-in"><span><span class="co"># For irregularly spaced observations, there are gaps. Therefore, some initial</span></span></span>
<span class="r-in"><span><span class="co"># ... regularisation may be beneficial here.</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.POSIXt.html" class="external-link">seq.POSIXt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">"2016-01-01"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">"2016-01-10"</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"1 min"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">x</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pretty_ts_mat</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, res <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 1: Set up...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 2: Defining time categories...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 3: Creating matrix of time (minutes) x time (days)...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 4: Plotting matrix of time (minutes) x time (days)...</span>
<span class="r-plt img"><img src="pretty_ts_mat-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Edward Lavender.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

      </footer></div>

  


  

  </body></html>

