<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Pretty periodogram plots — pretty_pgram • prettyGraphics</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Pretty periodogram plots — pretty_pgram" />
<meta property="og:description" content="This function produces a plot of a power spectrum. Power spectra can be estimated via spectrum or internally within this function. spectrum can also produce a plot of the power spectrum, but this function is designed to implement automatically some adjustments to this plot to facilitate interpretation. Specifically, under the default settings, this function (a) automatically scales the spectral density (by doubling) so that the area under the periodogram values equals the variance; (b) re-expresses frequencies in terms of the number of cycles per unit time (rather than the number of cycles per time interval), by dividing spectrum's frequencies by the sampling interval (sampling_interval); (c) can plot frequency (&quot;f&quot;) or period (&quot;T&quot;) on the x-axis; (d) provided the flexibility to re-adjust the x axis units (via x_units). The plot is produced by pretty_plot which can be customised via a named list of arguments that is passed to this function (plot_args)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">prettyGraphics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/introducing_prettyGraphics.html">Vignette: An introduction to prettyGraphics</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/edwardlavender/prettyGraphics/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Pretty periodogram plots</h1>
    <small class="dont-index">Source: <a href='https://github.com/edwardlavender/prettyGraphics/blob/master/R/pretty_pgram.R'><code>R/pretty_pgram.R</code></a></small>
    <div class="hidden name"><code>pretty_pgram.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function produces a plot of a power spectrum. Power spectra can be estimated via <code><a href='https://rdrr.io/r/stats/spectrum.html'>spectrum</a></code> or internally within this function. <code><a href='https://rdrr.io/r/stats/spectrum.html'>spectrum</a></code> can also produce a plot of the power spectrum, but this function is designed to implement automatically some adjustments to this plot to facilitate interpretation. Specifically, under the default settings, this function (a) automatically scales the spectral density (by doubling) so that the area under the periodogram values equals the variance; (b) re-expresses frequencies in terms of the number of cycles per unit time (rather than the number of cycles per time interval), by dividing <code><a href='https://rdrr.io/r/stats/spectrum.html'>spectrum</a></code>'s frequencies by the sampling interval (<code>sampling_interval</code>); (c) can plot frequency (<code>"f"</code>) or period (<code>"T"</code>) on the x-axis; (d) provided the flexibility to re-adjust the x axis units (via <code>x_units</code>). The plot is produced by <code><a href='pretty_plot.html'>pretty_plot</a></code> which can be customised via a named list of arguments that is passed to this function (<code>plot_args</code>).</p>
    </div>

    <pre class="usage"><span class='fu'>pretty_pgram</span><span class='op'>(</span>
  <span class='va'>x</span>,
  sampling_interval <span class='op'>=</span> <span class='cn'>NULL</span>,
  scale <span class='op'>=</span> <span class='cn'>TRUE</span>,
  log <span class='op'>=</span> <span class='cn'>FALSE</span>,
  x_units <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='va'>x</span>,
  x_type <span class='op'>=</span> <span class='st'>"f"</span>,
  plot_args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>type <span class='op'>=</span> <span class='st'>"l"</span>, col <span class='op'>=</span> <span class='st'>"blue"</span>, xlab <span class='op'>=</span> <span class='va'>x_type</span>, ylab <span class='op'>=</span> <span class='st'>"Spectral density"</span><span class='op'>)</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>An object of class "spec" (see <code><a href='https://rdrr.io/r/stats/spectrum.html'>spectrum</a></code>) or a univariate time series to be passed to <code><a href='https://rdrr.io/r/stats/spectrum.html'>spectrum</a></code>.</p></td>
    </tr>
    <tr>
      <th>sampling_interval</th>
      <td><p>A number that defines the sampling interval between sequential observations. If provided, this is used to re-express the frequencies that are returned by <code><a href='https://rdrr.io/r/stats/spectrum.html'>spectrum</a></code> (where they are defined as the number of time cycles per time interval) into the number of cycles per unit time.</p></td>
    </tr>
    <tr>
      <th>scale</th>
      <td><p>A logical input that defines whether or not to scale the spectral densities returned by <code><a href='https://rdrr.io/r/stats/spectrum.html'>spectrum</a></code> (by doubling) so that the area under the periodogram values equals the variance.</p></td>
    </tr>
    <tr>
      <th>log</th>
      <td><p>A logical input that defines whether or not to log (scaled) spectral densities. This is <code>FALSE</code> by default.</p></td>
    </tr>
    <tr>
      <th>x_units</th>
      <td><p>A function that is used to process the x-axis units, after having converted frequencies into the number of cycles per unit time. For example, if the x-axis is given as frequency per minute, <code>function(x) x*60</code> will convert the x-axis into frequency per hour.</p></td>
    </tr>
    <tr>
      <th>x_type</th>
      <td><p>A character input that specifies whether to plot frequencies (<code>"f"</code>) or periods (<code>"T"</code> = 1/f) on the x-axis.</p></td>
    </tr>
    <tr>
      <th>plot_args</th>
      <td><p>A named list of arguments that is passed to <code><a href='pretty_plot.html'>pretty_plot</a></code> to customise the plot that is produced.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>A logical input that defines whether or not to print messages to the console defining the actions implemented.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments to estimate the spectral density that are passed to <code><a href='https://rdrr.io/r/stats/spectrum.html'>spectrum</a></code>, if <code>x</code> is a univariate time series.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The function returns a plot of the spectral density (i.e., a spectral power plot).</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Edward Lavender</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='r-in'><span class='co'># Define plotting window</span></span>
<span class='r-in'><span class='va'>pp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'># Define a series of time stamps, with observations every 0.5 mins</span></span>
<span class='r-in'><span class='va'>delta</span> <span class='op'>&lt;-</span> <span class='fl'>0.5</span></span>
<span class='r-in'><span class='va'>t</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>30</span>, by <span class='op'>=</span> <span class='va'>delta</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'># Simulate a response, with a period of 5 (i.e., 5 mins between every cycle)</span></span>
<span class='r-in'><span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>sin</a></span><span class='op'>(</span><span class='op'>(</span><span class='op'>(</span><span class='fl'>2</span><span class='op'>*</span><span class='va'>pi</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>5</span><span class='op'>)</span><span class='op'>*</span><span class='va'>t</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>t</span>, <span class='va'>y</span>, type <span class='op'>=</span> <span class='st'>"l"</span>, xlab <span class='op'>=</span> <span class='st'>"Time (mins)"</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'># Visualise 'raw' periodogram</span></span>
<span class='r-in'><span class='fu'>stats</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/spectrum.html'>spectrum</a></span><span class='op'>(</span><span class='va'>y</span>, log <span class='op'>=</span> <span class='st'>"no"</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'># Default pretty_pgram adjustments</span></span>
<span class='r-in'><span class='co'># ... including converting frequency to per unit time (per minute)</span></span>
<span class='r-in'><span class='co'># ... 0.2 cycles per minute = 1/0.2 = period of 5 mins:</span></span>
<span class='r-in'><span class='fu'>pretty_pgram</span><span class='op'>(</span><span class='va'>y</span>, sampling_interval <span class='op'>=</span> <span class='va'>delta</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Estimating spectral density...</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Scaling spectral density...</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Re-expressing frequencies per unit time...</span>
<span class='r-in'><span class='co'># Plot period instead of frequency (i.e., expect a period of 5 minutes)</span></span>
<span class='r-in'><span class='fu'>pretty_pgram</span><span class='op'>(</span><span class='va'>y</span>, sampling_interval <span class='op'>=</span> <span class='va'>delta</span>, x_type <span class='op'>=</span> <span class='st'>"T"</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Estimating spectral density...</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Scaling spectral density...</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Re-expressing frequencies per unit time...</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Converting frequencies to periods...</span>
<span class='r-in'><span class='co'># Convert period into seconds (one period per 5 mins = one period per 300 seconds)</span></span>
<span class='r-in'><span class='fu'>pretty_pgram</span><span class='op'>(</span><span class='va'>y</span>,</span>
<span class='r-in'>             sampling_interval <span class='op'>=</span> <span class='va'>delta</span>,</span>
<span class='r-in'>             x_type <span class='op'>=</span> <span class='st'>"T"</span>,</span>
<span class='r-in'>             x_units <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='va'>x</span><span class='op'>/</span><span class='fl'>60</span></span>
<span class='r-in'>             <span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Estimating spectral density...</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Scaling spectral density...</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Re-expressing frequencies per unit time...</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Converting frequencies to periods...</span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span><span class='va'>pp</span><span class='op'>)</span></span>
<span class='r-plt img'><img src='pretty_pgram-1.png' alt='' width='700' height='433' /></span>
<span class='r-in'></span>
</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Edward Lavender.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


