<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Add error bars to a plot — add_error_bars • prettyGraphics</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Add error bars to a plot — add_error_bars"><meta property="og:description" content="This function is used to add error bars (and fitted values) to a plot. Fitted values are marked as points (if requested) around which error bars are drawn (horizontally or vertically as appropriate). Error bars can be specified via the values of the explanatory variable (x), the fitted values (fit) and (a) their standard errors (which are multiplied by a user-defined scale parameter to define the limits of each error bar) or (b) the lower and upper values of each error bar (lwr and upr) directly."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">prettyGraphics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/introducing_prettyGraphics.html">Vignette: An introduction to prettyGraphics</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/edwardlavender/prettyGraphics/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Add error bars to a plot</h1>
    <small class="dont-index">Source: <a href="https://github.com/edwardlavender/prettyGraphics/blob/HEAD/R/add_error_bars.R" class="external-link"><code>R/add_error_bars.R</code></a></small>
    <div class="hidden name"><code>add_error_bars.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function is used to add error bars (and fitted values) to a plot. Fitted values are marked as points (if requested) around which error bars are drawn (horizontally or vertically as appropriate). Error bars can be specified via the values of the explanatory variable (<code>x</code>), the fitted values (<code>fit</code>) and (a) their standard errors (which are multiplied by a user-defined <code>scale</code> parameter to define the limits of each error bar) or (b) the lower and upper values of each error bar (<code>lwr</code> and <code>upr</code>) directly.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">add_error_bars</span><span class="op">(</span>
  <span class="va">x</span>,
  <span class="va">fit</span>,
  se <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>,
  scale <span class="op">=</span> <span class="fl">1</span>,
  lwr <span class="op">=</span> <span class="va">fit</span> <span class="op">-</span> <span class="va">scale</span> <span class="op">*</span> <span class="va">se</span>,
  upr <span class="op">=</span> <span class="va">fit</span> <span class="op">+</span> <span class="va">scale</span> <span class="op">*</span> <span class="va">se</span>,
  length <span class="op">=</span> <span class="fl">0.05</span>,
  horiz <span class="op">=</span> <span class="cn">FALSE</span>,
  add_fit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pch <span class="op">=</span> <span class="fl">21</span>, bg <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,
  add_fitted <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>The values of an explanatory variable at which the error bars will be placed (e.g. factor levels).</p></dd>
<dt>fit</dt>
<dd><p>The fitted values from a model, around which error bars will be drawn.</p></dd>
<dt>se, scale</dt>
<dd><p>A number or vector of numbers that define(s) the standard error(s) (<code>se</code>) and a scaling parameter (<code>scale</code>) that, together, define the size of the error bars above and below fitted values. Standard errors are multiplied by the scaling parameter (e.g. to convert standard errors into 95 percent confidence intervals). This results in symmetric error bars. Alternatively, the lower and upper limits of the error bars can be defined directly via <code>lwr</code> and <code>upr</code>.</p></dd>
<dt>lwr, upr</dt>
<dd><p>A vector of numbers, of the same length as <code>x</code>, that defines the lower (<code>lwr</code>) and upper (<code>upr</code>) limits of the error bars. By default, these are defined using the <code>se</code> and <code>scale</code> arguments, but they can be defined by the user instead (e.g., if a model returns 95 percent confidence intervals, rather than standard errors, or if error bars are asymmetrical).</p></dd>
<dt>length</dt>
<dd><p>A numeric value which defines the length of the horizontal tips of the error bars. <code>length = 0</code> will suppress the horizontal tips of error bars.</p></dd>
<dt>horiz</dt>
<dd><p>A logical value that defines whether or not error bars will be drawn vertically (<code>FALSE</code>) or horizontally (<code>TRUE</code>). For vertical error bars, <code>x</code> and <code>fit</code> are taken as the x positions at/around which error bars are drawn; this is reversed for horizontal error bars.</p></dd>
<dt>add_fit</dt>
<dd><p>A named list of graphical parameters, passed to <code><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></code> which, if provided, will add fitted values as points on top of error bars. An empty list (<code>add_fit = list()</code>) will add fitted values to the plot using default graphical parameters.</p></dd>
<dt>add_fitted</dt>
<dd><p>(depreciated) See <code>add_fit</code> argument.</p></dd>
<dt>...</dt>
<dd><p>Other arguments passed to <code><a href="https://rdrr.io/r/graphics/arrows.html" class="external-link">arrows</a></code>, which is used to draw error bars, for customisation. Arguments <code>x0</code>, <code>x1</code>, <code>y0</code> and <code>y1</code> are obtained from <code>x</code>, <code>fit</code>, and <code>se</code> and <code>scale</code>, or <code>lwr</code> and <code>upr</code>, and should not be provided. Likewise, <code>angle</code> is forced to be 90 degrees (i.e., error bars are forced to have horizontal tips (or no tips, if <code>length = 0</code>)) and should not be provided.</p></dd>
</dl></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>This function is designed for discrete explanatory variables. <code><a href="add_error_envelope.html">add_error_envelope</a></code> is used for continuous explanatory variables to add regression lines and associated error envelopes to plots.</p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Edward Lavender</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co">#### Example dataframe</span></span>
<span class="r-in"><span class="co"># Define a hypothetical dataframe with predictor values and fitted values</span></span>
<span class="r-in"><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>,</span>
<span class="r-in">                  fit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">30</span>, <span class="fl">40</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#### Example (1): Vertical error bars</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Vertical error bars based on SE</span></span>
<span class="r-in"><span class="co"># Visualise vertical error bars based on (hypothetical) SE</span></span>
<span class="r-in"><span class="fu"><a href="pretty_plot.html">pretty_plot</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">type</span>, <span class="va">sim</span><span class="op">$</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"n"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">50</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> pretty$n greater than the number of factor levels; resetting n to be the total number of factor levels.</span>
<span class="r-in"><span class="fu">add_error_bars</span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">type</span>, <span class="va">sim</span><span class="op">$</span><span class="va">fit</span>, se <span class="op">=</span> <span class="fl">5</span>, lwd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> x values converted to a number for plotting.</span>
<span class="r-plt img"><img src="add_error_bars-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="co"># Adjust SE before implementing the function to show CIs</span></span>
<span class="r-in"><span class="fu"><a href="pretty_plot.html">pretty_plot</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">type</span>, <span class="va">sim</span><span class="op">$</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"n"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">50</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> pretty$n greater than the number of factor levels; resetting n to be the total number of factor levels.</span>
<span class="r-in"><span class="fu">add_error_bars</span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">type</span>, <span class="va">sim</span><span class="op">$</span><span class="va">fit</span>, se <span class="op">=</span> <span class="fl">5</span><span class="op">*</span><span class="fl">1.96</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> x values converted to a number for plotting.</span>
<span class="r-plt img"><img src="add_error_bars-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="co"># Or simply adjust the arument to 'scale'</span></span>
<span class="r-in"><span class="fu"><a href="pretty_plot.html">pretty_plot</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">type</span>, <span class="va">sim</span><span class="op">$</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"n"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">50</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> pretty$n greater than the number of factor levels; resetting n to be the total number of factor levels.</span>
<span class="r-in"><span class="fu">add_error_bars</span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">type</span>, <span class="va">sim</span><span class="op">$</span><span class="va">fit</span>, se <span class="op">=</span> <span class="fl">5</span><span class="op">*</span><span class="fl">1.96</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> x values converted to a number for plotting.</span>
<span class="r-plt img"><img src="add_error_bars-3.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Vertical error bars based on lwr and upper estimates</span></span>
<span class="r-in"><span class="va">sim</span><span class="op">$</span><span class="va">lwr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">5</span>, <span class="fl">35</span><span class="op">)</span></span>
<span class="r-in"><span class="va">sim</span><span class="op">$</span><span class="va">upr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">40</span>, <span class="fl">45</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="pretty_plot.html">pretty_plot</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">type</span>, <span class="va">sim</span><span class="op">$</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"n"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">50</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> pretty$n greater than the number of factor levels; resetting n to be the total number of factor levels.</span>
<span class="r-in"><span class="fu">add_error_bars</span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">type</span>, <span class="va">sim</span><span class="op">$</span><span class="va">fit</span>, lwr <span class="op">=</span> <span class="va">sim</span><span class="op">$</span><span class="va">lwr</span>, upr <span class="op">=</span> <span class="va">sim</span><span class="op">$</span><span class="va">upr</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> x values converted to a number for plotting.</span>
<span class="r-plt img"><img src="add_error_bars-4.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#### Example (2): Horizontal error bars</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Horizontal error bars (via horiz = TRUE) based on SEs</span></span>
<span class="r-in"><span class="fu"><a href="pretty_plot.html">pretty_plot</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">fit</span>, <span class="va">sim</span><span class="op">$</span><span class="va">type</span>, type <span class="op">=</span> <span class="st">"n"</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">50</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> pretty$n greater than the number of factor levels; resetting n to be the total number of factor levels.</span>
<span class="r-in"><span class="fu">add_error_bars</span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">type</span>, <span class="va">sim</span><span class="op">$</span><span class="va">fit</span>, se <span class="op">=</span> <span class="fl">5</span>, horiz <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> x values converted to a number for plotting.</span>
<span class="r-plt img"><img src="add_error_bars-5.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Horizontal error bars (via horiz = TRUE) based on lwr and upr estimates</span></span>
<span class="r-in"><span class="fu"><a href="pretty_plot.html">pretty_plot</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">fit</span>, <span class="va">sim</span><span class="op">$</span><span class="va">type</span>, type <span class="op">=</span> <span class="st">"n"</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">50</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> pretty$n greater than the number of factor levels; resetting n to be the total number of factor levels.</span>
<span class="r-in"><span class="fu">add_error_bars</span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">type</span>, <span class="va">sim</span><span class="op">$</span><span class="va">fit</span>, lwr <span class="op">=</span> <span class="va">sim</span><span class="op">$</span><span class="va">lwr</span>, upr <span class="op">=</span> <span class="va">sim</span><span class="op">$</span><span class="va">upr</span>, horiz <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> x values converted to a number for plotting.</span>
<span class="r-plt img"><img src="add_error_bars-6.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#### Example (3) Customise error bars by supplying additional arguments via ...</span></span>
<span class="r-in"><span class="co"># ... that are passed to graphics::arrows()</span></span>
<span class="r-in"><span class="fu"><a href="pretty_plot.html">pretty_plot</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">type</span>, <span class="va">sim</span><span class="op">$</span><span class="va">fit</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> pretty$n greater than the number of factor levels; resetting n to be the total number of factor levels.</span>
<span class="r-in"><span class="fu">add_error_bars</span><span class="op">(</span>x <span class="op">=</span> <span class="va">sim</span><span class="op">$</span><span class="va">type</span>, fit <span class="op">=</span> <span class="va">sim</span><span class="op">$</span><span class="va">fit</span>, se <span class="op">=</span> <span class="fl">5</span>,</span>
<span class="r-in">               length <span class="op">=</span> <span class="fl">0.25</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> x values converted to a number for plotting.</span>
<span class="r-plt img"><img src="add_error_bars-7.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#### Example (4): Add the fitted points on by passing a list to the add_fit argument:</span></span>
<span class="r-in"><span class="va">pp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># Example with customised points:</span></span>
<span class="r-in"><span class="fu"><a href="pretty_plot.html">pretty_plot</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">type</span>, <span class="va">sim</span><span class="op">$</span><span class="va">fit</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> pretty$n greater than the number of factor levels; resetting n to be the total number of factor levels.</span>
<span class="r-in"><span class="fu">add_error_bars</span><span class="op">(</span>x <span class="op">=</span> <span class="va">sim</span><span class="op">$</span><span class="va">type</span>, fit <span class="op">=</span> <span class="va">sim</span><span class="op">$</span><span class="va">fit</span>, se <span class="op">=</span> <span class="fl">5</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span class="r-in">               add_fit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pch <span class="op">=</span> <span class="fl">21</span>, bg <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> x values converted to a number for plotting.</span>
<span class="r-in"><span class="co"># Simply specify an empty list to use the default options:</span></span>
<span class="r-in"><span class="fu"><a href="pretty_plot.html">pretty_plot</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">type</span>, <span class="va">sim</span><span class="op">$</span><span class="va">fit</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> pretty$n greater than the number of factor levels; resetting n to be the total number of factor levels.</span>
<span class="r-in"><span class="fu">add_error_bars</span><span class="op">(</span>x <span class="op">=</span> <span class="va">sim</span><span class="op">$</span><span class="va">type</span>, fit <span class="op">=</span> <span class="va">sim</span><span class="op">$</span><span class="va">fit</span>, se <span class="op">=</span> <span class="fl">5</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span class="r-in">               add_fit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> x values converted to a number for plotting.</span>
<span class="r-plt img"><img src="add_error_bars-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">pp</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#### Example (5): More realistic example using model derived estimates</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Simulate data</span></span>
<span class="r-in"><span class="co"># Imagine a scenario where we have n observations for j factor levels</span></span>
<span class="r-in"><span class="co"># Successive factor levels have expected values that differ by 10 units</span></span>
<span class="r-in"><span class="co"># The observed response is normally distributed around expected values with some sd</span></span>
<span class="r-in"><span class="co">## Simulate data</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">30</span>; <span class="va">j</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span class="r-in"><span class="va">fct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">j</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># Define means for each factor level</span></span>
<span class="r-in"><span class="va">mean_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">10</span>, by <span class="op">=</span> <span class="fl">10</span>, length.out <span class="op">=</span> <span class="va">j</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># Define expected values for each fct</span></span>
<span class="r-in"><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="va">fct</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">mean_vec</span></span>
<span class="r-in"><span class="co"># Define simulated observations</span></span>
<span class="r-in"><span class="va">sd</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span class="r-in"><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span>, <span class="va">mu</span>, <span class="va">sd</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Use a model to extract fitted values/coefficients</span></span>
<span class="r-in"><span class="co"># Model data, using a means parameterisation for convenience</span></span>
<span class="r-in"><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">fct</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># Extract fitted values and coefficients</span></span>
<span class="r-in"><span class="va">coef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span></span>
<span class="r-in"><span class="va">fit</span> <span class="op">&lt;-</span> <span class="va">coef</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>; <span class="va">fit</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     fct1     fct2     fct3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10.41229 20.66387 30.55139 </span>
<span class="r-in"><span class="va">se</span> <span class="op">&lt;-</span> <span class="va">coef</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>; <span class="va">se</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      fct1      fct2      fct3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.8179924 0.8179924 0.8179924 </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Add error bars using the default options:</span></span>
<span class="r-in"><span class="va">pch_col</span> <span class="op">&lt;-</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html" class="external-link">alpha</a></span><span class="op">(</span><span class="st">"royalblue"</span>, <span class="fl">0.4</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="pretty_plot.html">pretty_plot</a></span><span class="op">(</span><span class="va">fct</span>, <span class="va">y</span>, pch <span class="op">=</span> <span class="fl">21</span>, col <span class="op">=</span> <span class="va">pch_col</span>, bg <span class="op">=</span> <span class="va">pch_col</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> pretty$n greater than the number of factor levels; resetting n to be the total number of factor levels.</span>
<span class="r-in"><span class="fu">add_error_bars</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, fit <span class="op">=</span> <span class="va">fit</span>, se <span class="op">=</span> <span class="va">se</span><span class="op">)</span></span>
<span class="r-plt img"><img src="add_error_bars-9.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Edward Lavender.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

